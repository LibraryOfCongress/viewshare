define("ext/time/scripts/base",[],function(){var e;return e={params:{bundle:!0,prefix:null},paramTypes:{bundle:Boolean,prefix:String},urlPrefix:null,cssFiles:["styles/main.css"],bundledCssFile:"styles/time-extension-bundle.css"},e}),define("scripts/ui/coordinator",["lib/jquery","./ui-context"],function(e,t){var n=function(t,r){this._listeners=[];var i,s,o,u,a,f;a=this,i=r,s=null,o=t,u=!1,this.getID=function(){return s},this.getUIContext=function(){return o},this.getContainer=function(){return e(i)},f=function(){typeof i!="undefined"&&i!==null&&(s=e(i).attr("id"));if(typeof s=="undefined"||s===null)s=a.getUIContext().getCollection().getID()+"-"+a.getUIContext().getMain().getRegistry().generateIdentifier(n.getRegistryKey())},this.register=function(){this.getUIContext().getMain().getRegistry().register(n.getRegistryKey(),this.getID(),this),u=!0},this.unregister=function(){a.getUIContext().getMain().getRegistry().unregister(n.getRegistryKey(),a.getID()),u=!1},this.dispose=function(){typeof this._dispose!="undefined"&&this._dispose(),this.unregister(),this.getUIContext().dispose(),s=null,i=null,o=null,a=null},f()};return n._registryKey="coordinator",n.getRegistryKey=function(){return n._registryKey},n.registerComponent=function(e,t){t.hasRegistry(n.getRegistryKey())||t.createRegistry(n.getRegistryKey())},n.create=function(e,t){var r=new n(t);return r.register(),r},n.createFromDOM=function(e,r){var i=new n(t.createFromDOM(e,r,!1),e);return i.register(),i},n.prototype.addListener=function(e){var t=new n._Listener(this,e);return this._listeners.push(t),t},n.prototype._removeListener=function(e){var t;for(t=0;t<this._listeners.length;t++)if(this._listeners[t]===e){this._listeners.splice(t,1);return}},n.prototype._fire=function(e,t){var n,r;for(n=0;n<this._listeners.length;n++)r=this._listeners[n],r!==e&&r._callback(t)},n._Listener=function(e,t){this._coordinator=e,this._callback=t},n._Listener.prototype.dispose=function(){this._coordinator._removeListener(this)},n._Listener.prototype.fire=function(e){this._coordinator._fire(this,e)},e(document).on("registerComponents.exhibit",n.registerComponent),n}),define("scripts/ui/coders/coder",["lib/jquery"],function(e){var t=function(n,r,i){var s,o,u,a,f,l,c;s=this,l=e(r),f=i,o=n,u=!1,a=null,this._settingSpecs={},this._settings={},this.addSettingSpecs=function(t){e.extend(!0,this._settingSpecs,t)},this.getSettingSpecs=function(){return this._settingSpecs},this.getID=function(){return a},this.getUIContext=function(){return f},this.getContainer=function(){return l},this.register=function(){this.getUIContext().getMain().getRegistry().register(t.getRegistryKey(),this.getID(),this),u=!0},this.unregister=function(){s.getUIContext().getMain().getRegistry().unregister(t.getRegistryKey(),s.getID()),u=!1},this._dispose=function(){this._settingSpecs=null,this._settings=null,e(l).empty(),l=null,this.unregister(),f=null},c=function(){a=e(l).attr("id");if(typeof a=="undefined"||a===null)a=o+"-"+s.getUIContext().getCollection().getID()+"-"+s.getUIContext().getMain().getRegistry().generateIdentifier(t.getRegistryKey())},c()};return t._registryKey="coder",t.getRegistryKey=function(){return t._registryKey},t.registerComponent=function(e,n){n.hasRegistry(t.getRegistryKey())||n.createRegistry(t.getRegistryKey())},e(document).on("registerComponents.exhibit",t.registerComponent),t}),define("ext/time/scripts/timeline-view",["lib/jquery","exhibit","timeline","./base","scripts/util/set","scripts/util/date-time","scripts/util/accessors","scripts/util/settings","scripts/util/views","scripts/ui/ui-context","scripts/ui/views/view","scripts/ui/coordinator","scripts/ui/coders/coder","scripts/ui/coders/default-color-coder"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d=function(t,n){var r=this;e.extend(this,new l("time",t,n)),this.addSettingSpecs(d._settingSpecs),this._accessors={getEventLabel:function(e,t,n){n(t.getObject(e,"label"))},getProxy:function(e,t,n){n(e)},getColorKey:null,getIconKey:null},this._dom=null,this._selectListener=null,this._largestSize=0,this._iconCoder=null,this._colorCoder=null,this._eventSource=null,this._timeline=null,this._onItemsChanged=function(){r._reconstruct()},e(n.getCollection().getElement()).bind("onItemsChanged.exhibit",r._onItemsChanged),this.register()};return d._intervalChoices=["millisecond","second","minute","hour","day","week","month","year","decade","century","millennium"],d._settingSpecs={topBandHeight:{type:"int",defaultValue:75},topBandUnit:{type:"enum",choices:d._intervalChoices},topBandPixelsPerUnit:{type:"int",defaultValue:200},bottomBandHeight:{type:"int",defaultValue:25},bottomBandUnit:{type:"enum",choices:d._intervalChoices},bottomBandPixelsPerUnit:{type:"int",defaultValue:200},timelineHeight:{type:"int",defaultValue:400},timelineConstructor:{type:"function",defaultValue:null},colorCoder:{type:"text",defaultValue:null},iconCoder:{type:"text",defaultValue:null},selectCoordinator:{type:"text",defaultValue:null},showHeader:{type:"boolean",defaultValue:!0},showSummary:{type:"boolean",defaultValue:!0},showFooter:{type:"boolean",defaultValue:!0}},d._accessorSpecs=[{accessorName:"getProxy",attributeName:"proxy"},{accessorName:"getDuration",bindings:[{attributeName:"start",type:"date",bindingName:"start"},{attributeName:"end",type:"date",bindingName:"end",optional:!0}]},{accessorName:"getColorKey",attributeName:"marker",type:"text"},{accessorName:"getColorKey",attributeName:"colorKey",type:"text"},{accessorName:"getIconKey",attributeName:"iconKey",type:"text"},{accessorName:"getEventLabel",attributeName:"eventLabel",type:"text"},{accessorName:"getHoverText",attributeName:"hoverText",type:"text"},{accessorName:"getCaption",attributeName:"caption",type:"text"}],d.create=function(e,t,n){var r=new d(t,f.create(e,n));return d._configure(r,e),r._internalValidate(),r._initializeUI(),r},d.createFromDOM=function(e,n,r){var i,s;return i=t.getConfigurationFromDOM(e),s=new d(n!==null?n:e,f.createFromDOM(e,r)),o.createAccessorsFromDOM(e,d._accessorSpecs,s._accessors),u.collectSettingsFromDOM(e,s.getSettingSpecs(),s._settings),d._configure(s,i),s._internalValidate(),s._initializeUI(),s},d._configure=function(e,t){var n;o.createAccessors(t,d._accessorSpecs,e._accessors),u.collectSettings(t,e.getSettingSpecs(),e._settings),n=e._accessors,e._getDuration=function(e,t,r){n.getProxy(e,t,function(e){n.getDuration(e,t,r)})}},d.prototype.dispose=function(){e(this.getUIContext().getCollection().getElement()).unbind("onItemsChanged.exhibit",this._onItemsChanged),this._timeline=null,this._selectListener!==null&&(this._selectListener.dispose(),this._selectListener=null),this._dom.dispose(),this._dom=null,this._dispose()},d.prototype._internalValidate=function(){var e,t;typeof this._accessors.getColorKey!="undefined"&&(typeof this._settings.colorCoder!="undefined"&&(this._colorCoder=this.getUIContext().getMain().getRegistry().get(h.getRegistryKey(),this._settings.colorCoder)),this._colorCoder===null&&(this._colorCoder=new p(this.getUIContext()))),typeof this._accessors.getIconKey!="undefined"&&(this._iconCoder=null,typeof this._settings.iconCoder!="undefined"&&(this._iconCoder=this.getUIContext().getMain().getRegistry().get(h.getRegistryKey(),this._settings.iconCoder))),typeof this._settings.selectCoordinator!="undefined"&&(e=this.getUIContext().getMain().getRegistry().get(c.getRegistryKey(),this._settings.selectCoordinator),e!==null&&(t=this,this._selectListener=e.addListener(function(e){t._select(e)})))},d.prototype._initializeUI=function(){var t,r;t=this,r={},r.colorGradient=this._colorCoder!==null&&typeof this._colorCoder._gradientPoints!="undefined",r.iconMarkerGenerator=function(t){var n=e("<img>").attr("src",t).css("verticalAlign","middle");return n.get(0)},e(this.getContainer()).empty(),this._dom=a.constructPlottingViewDom(this.getContainer(),this.getUIContext(),this._settings.showSummary&&this._settings.showHeader,{onResize:function(){t._timeline.layout()}},r),this._eventSource=new n.DefaultEventSource,t._initializeViewUI(),this._reconstruct()},d.prototype._reconstructTimeline=function(t){var r,i,o,u,a,f,l,c,h,p,v,m,g,y,b,w;r=this._settings,this._timeline!==null&&this._timeline.dispose(),typeof t!="undefined"&&t!==null&&this._eventSource.addMany(t),i=this._dom.plotContainer;if(r.timelineConstructor!==null)this._timeline=r.timelineConstructor(i,this._eventSource);else{e(i).css("height",r.timelineHeight+"px").attr("class","exhibit-timelineView-timeline"),o=n.ClassicTheme.create(),o.event.bubble.width=this.getUIContext().getSetting("bubbleWidth"),o.event.bubble.height=this.getUIContext().getSetting("bubbleHeight");if(typeof r.topBandUnit!="undefined"&&r.topBandUnit!==null||typeof r.bottomBandUnit!="undefined"&&r.bottomBandUnit!==null){if(typeof d._intervalLabelMap=="undefined"||d._intervalLabelMap===null)d._intervalLabelMap={millisecond:s.MILLISECOND,second:s.SECOND,minute:s.MINUTE,hour:s.HOUR,day:s.DAY,week:s.WEEK,month:s.MONTH,year:s.YEAR,decade:s.DECADE,century:s.CENTURY,millennium:s.MILLENNIUM};typeof r.topBandUnit=="undefined"||r.topBandUnit===null?(a=d._intervalLabelMap[r.bottomBandUnit],u=a-1):typeof r.bottomBandUnit=="undefined"||r.bottomBandUnit===null?(u=d._intervalLabelMap[r.topBandUnit],a=u+1):(u=d._intervalLabelMap[r.topBandUnit],a=d._intervalLabelMap[r.bottomBandUnit])}else{f=this._eventSource.getEarliestDate(),l=this._eventSource.getLatestDate(),c=l.getTime()-f.getTime(),h=this._eventSource.getCount();if(c>0&&h>1){p=h/c,u=s.MILLENNIUM;while(u>0){v=s.gregorianUnitLengths[u],m=p*v/r.topBandPixelsPerUnit;if(m<.01)break;u--}}else u=s.YEAR;a=u+1}g=[n.createBandInfo({width:r.topBandHeight+"%",intervalUnit:u,intervalPixels:r.topBandPixelsPerUnit,eventSource:this._eventSource,theme:o}),n.createBandInfo({width:r.bottomBandHeight+"%",intervalUnit:a,intervalPixels:r.bottomBandPixelsPerUnit,eventSource:this._eventSource,overview:!0,theme:o})],g[1].syncWith=0,g[1].highlight=!0,this._timeline=n.create(i,g,n.HORIZONTAL)}y=this,b=function(e){y._selectListener!==null&&y._selectListener.fire({itemIDs:[e]})};for(w=0;w<this._timeline.getBandCount();w++)this._timeline.getBand(w).getEventPainter().addOnSelectListener(b)},d.prototype._reconstruct=function(){var e,t,r,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O;e=this,t=this.getUIContext().getCollection(),r=this.getUIContext().getDatabase(),s=this._settings,o=this._accessors,u=t.countRestrictedItems(),a=[],this._dom.legendWidget.clear(),this._eventSource.clear();if(u>0){f=t.getRestrictedItems(),l=this._accessors.getColorKey!==null,c=this._accessors.getIconKey!==null&&this._iconCoder!==null,h=this._accessors.getHoverText!==null,p=this._accessors.getCaption!==null,d={mixed:!1,missing:!1,others:!1,keys:new i},v={mixed:!1,missing:!1,others:!1,keys:new i},m=[],g=function(t,i,s,u,a){var f,l;o.getEventLabel(t,r,function(e){return f=e,!0}),l=new n.DefaultEventSource.Event({id:t,eventID:t,start:i.start,end:i.end,instant:i.end===null,text:f,description:"",icon:u,color:s,textColor:s,caption:a}),l._itemID=t,l.getProperty=function(e){return r.getObject(this._itemID,e)},l.fillInfoBubble=function(t,n,r){e._fillInfoBubble(this,t,n,r)},m.push(l)},f.visit(function(t){var n,s,u,f,m,y,b,w;n=[],e._getDuration(t,r,function(e){typeof e.start!="undefined"&&n.push(e)});if(n.length>0){s=null,u=null,f=null,l&&(m=new i,o.getColorKey(t,r,function(e){m.add(e)}),s=e._colorCoder.translateSet(m,d)),u=null,c&&(y=new i,o.getIconKey(t,r,function(e){y.add(e)}),u=e._iconCoder.translateSet(y,v));if(h){b=new i,o.getHoverText(t,r,function(e){b.add(e)});for(w in b._hash)b._hash.hasOwnProperty(w)&&(f=w)}if(p){b=new i,o.getCaption(t,r,function(e){b.add(e)});for(w in b._hash)b._hash.hasOwnProperty(w)&&(f=w)}for(w=0;w<n.length;w++)g(t,n[w],s,u,f)}else a.push(t)});if(l){y=this._dom.legendWidget,b=this._colorCoder,w=d.keys.toArray().sort();if(typeof this._colorCoder._gradientPoints!="undefined"&&this._colorCoder._gradientPoints!==null)y.addGradient(this._colorCoder._gradientPoints);else for(E=0;E<w.length;E++)S=w[E],x=b.translate(S),y.addEntry(x,S);d.others&&y.addEntry(b.getOthersColor(),b.getOthersLabel()),d.mixed&&y.addEntry(b.getMixedColor(),b.getMixedLabel()),d.missing&&y.addEntry(b.getMissingColor(),b.getMissingLabel())}if(c){y=this._dom.legendWidget,T=this._iconCoder,w=v.keys.toArray().sort(),typeof s.iconLegendLabel!="undefined"&&s.iconLegendLabel!==null&&y.addLegendLabel(s.iconLegendLabel,"icon");for(E=0;E<w.length;E++)S=w[E],N=T.translate(S),y.addEntry(N,S,"icon");v.others&&y.addEntry(T.getOthersIcon(),T.getOthersLabel(),"icon"),v.mixed&&y.addEntry(T.getMixedIcon(),T.getMixedLabel(),"icon"),v.missing&&y.addEntry(T.getMissingIcon(),T.getMissingLabel(),"icon")}C=u-a.length,C>this._largestSize?(this._largestSize=C,this._reconstructTimeline(m)):this._eventSource.addMany(m),k=this._timeline.getBand(0),L=k.getCenterVisibleDate(),A=this._eventSource.getEarliestDate(),O=this._eventSource.getLatestDate(),typeof A!="undefined"&&A!==null&&L<A?k.scrollToCenter(A):typeof O!="undefined"&&O!==null&&L>O&&k.scrollToCenter(O)}this._dom.setUnplottableMessage(u,a)},d.prototype._select=function(e){var t,n,r,i,s;t=e.itemIDs[0],n=this._timeline.getBandCount();for(r=0;r<n;r++){i=this._timeline.getBand(r),s=i.getEventSource().getEvent(t);if(typeof s!="undefined"&&s!==null){i.showBubbleForEvent(t);break}}},d.prototype._fillInfoBubble=function(t,n,r,i){this.getUIContext().getLensRegistry().createLens(t._itemID,e(n),this.getUIContext())},d}),define("ext/time/nls/locale",{root:!0,de:!0,es:!0,fr:!0,nl:!0,sv:!0}),define("ext/time/time-extension",["module","lib/jquery","exhibit","./scripts/base","./scripts/timeline-view","i18n!ext/time/nls/locale","scripts/util/debug"],function(e,t,n,r,i,s,o){return r.TimelineView=i,r.register=function(e){e.TimeExtension=r,e.TimelineView=i},r.setup=function(){var i,u,a,f,l;t(document).trigger("loadLocale.exhibit",s),i=null,a=e.config();if(typeof Exhibit_TimeExtension_urlPrefix=="string")f=Exhibit_TimeExtension_urlPrefix;else if(a!==null&&a.hasOwnProperty("prefix"))f=a.prefix;else{l=["/time-extension.js","/time-extension-bundle.js"];for(u=0;u<l.length;u++){i=n.findScript(document,l[u]);if(i!==null){f=i.substr(0,i.indexOf(l[u]));break}}if(i===null){o.exception(new Error("Failed to derive URL prefix for SIMILE Exhibit Time Extension files"));return}}f.substr(-1)!=="/"&&(f+="/"),r.urlPrefix=f,typeof Exhibit_TimeExtension_parameters!="undefined"?r.params=n.parseURLParameters(Exhibit_TimeExtension_parameters,r.params,r.paramTypes):a!==null?r.params=a:i!==null&&(r.params=n.parseURLParameters(i,r.params,r.paramTypes)),r.params.bundle?n.includeCssFile(document,r.urlPrefix+r.bundledCssFile):n.includeCssFiles(document,r.urlPrefix,r.cssFiles)},t(document).ready(r.setup),r}),define("ext/time/nls/de/locale",{"%TimelineView.label":"Zeitleiste","%TimelineView.tooltip":"Zeige diese Elemente auf einer Zeitleiste"}),define("ext/time/nls/es/locale",{"%TimelineView.label":"Diagrama Temporal","%TimelineView.tooltip":"Ver elementos organizados temporalmente"}),define("ext/time/nls/fr/locale",{"%TimelineView.label":"Ligne de temps","%TimelineView.tooltip":"Voir les items sur une ligne de temps"}),define("ext/time/nls/nl/locale",{"%TimelineView.label":"Tijdlijn","%TimelineView.tooltip":"Bekijk items op een tijdlijn"}),define("ext/time/nls/root/locale",{"%TimelineView.label":"Timeline","%TimelineView.tooltip":"View items on a timeline"}),define("ext/time/nls/sv/locale",{"%TimelineView.label":"Tidslinje","%TimelineView.tooltip":"Visa på tidslinje"});