{% extends "site_base.html" %}
{% load url from future %}


{% load i18n %}
{% load freemix_helpers %}
{% load exhibit_tags %}
{% load compress %}

{% block head_title %}{% blocktrans %}Builder{% endblocktrans %}{% endblock %}

{% block rtab_id %}id="builder_tab"{% endblock %}
{% block body_class %}attraction{% endblock %}

{% block subnav %}

{% endblock %}

{% block head_data %}
    <link rel="exhibit/data" href="{{ data_url }}"/>
    <link rel="exhibit/data" href="{{dataset_properties_cache_json}}"/>

    <link rel="freemix/dataprofile" href="{{ dataset_profile_url }}"/>
    <link rel="freemix/exhibit_profile" href="{{ exhibit_profile_url }}"/>
{% endblock %}

{% block head_css %}
{{block.super}}
{% compress css %}
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}freemix/css/layout.css"/>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}freemix/css/views.css"/>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}freemix/css/editor.css"/>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}exhibit/css/canvas.css"/>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}exhibit/css/smoothness/smoothness.css"/>

{% include "simile/css/exhibit.html" %}
{% include "simile/css/exhibit_extensions.html" %}
{% endcompress %}
{% endblock head_css %}


{% block head_scripts %}
    {{ block.super }}
    {% include "simile/js/exhibit.html" %}
    {% include "simile/js/exhibit_extensions.html" %}
    {% compress js %}

    <script type="text/javascript" src="{{STATIC_URL}}freemix/js/lib/jquery-ui.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}freemix/js/lib/ui.multiselect.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}freemix/js/lib/jquery.form.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}freemix/js/lib/jquery.jeditable.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}freemix/js/lib/hoverIntent.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}freemix/js/lib/jquery.uuid.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}freemix/js/lib/jquery.cookie.js"></script>
    <script type="text/javascript" src="{{STATIC_URL}}freemix/js/lib/jquery.json.js"></script>
    {% endcompress %}

    {% include "exhibit/widget_js.html" with editor="True" %}

{% endblock head_scripts %}

{% block body %}

{#{% if exhibit %}#}
<div class="exhibit_edit">

  <ul class="exhibit_list_items">

    <li class="exhibit_list_item result_set_item clearfix {% if exhibit.published %}public{% elif exhibit %}private{% endif %}">
      {% if exhibit %}
        <div class="row-fluild">
          <div class="span12">
            <div class="exhibit-title"><a href="{{  exhibit.get_absolute_url }}">{{exhibit.title}}</a></div>

            {% if exhibit.description %}
            {% ifnotequal exhibit.description exhibit.description|truncatewords:100 %}

            <div class="exhibit-description exhibit-short-description">
              {{ exhibit.description|truncatewords:100 }}
              <a class="readmore" href="{{ exhibit.get_absolute_url }}">read more</a>
            </div>
            <div class="exhibit-description exhibit-long-description ui-helper-hidden">
              {{ exhibit.description }}
            </div>
            {%  else %}
            <div class="exhibit-description">
              {{ exhibit.description }}
            </div>
            {% endifnotequal %}
            {% endif %}
          </div>
        </div> <!-- row-fluid -->

        <div class="row-fluid">
          <div class="span12">
            <div class="exhibit-metadata">
              {% trans "Created by"%}
              <span class="exhibit-creator"><a href="{% url 'profile_detail' exhibit.owner.username %}">{{exhibit.owner|nicename}}</a></span>
              {% trans "on"%}
              <span class="exhibit-modified-data">{{exhibit.modified|date:"N j, Y"}}</span>.
            </div>
          </div>
        </div>
      {% else %}
        <div class="row-fluid">
          <div class="span7">
            <div class="exhibit-title">New View</div>
          </div>
        </div>
      {% endif %}

      <div class="row-fluid">
        <div class="span12">
            <div class="btn-group" >
                <button class="btn" id="preview_button" data-toggle="collapse" data-target="#preview">{% trans "Preview" %}</button>
                <button class="btn" id="builder_button" data-toggle="collapse" data-target="#build">{% trans "Builder" %}</button>
                <button class="btn" id="lens_button" data-toggle="collapse" data-target="#lens_navigator">{% trans "Lenses" %}</button>
            </div>
          <div class="exhibit-actions">
            <div class="btn-group pull-right">
              <button class="btn" id="save_button">{% trans "Save" %}</button>
              <a href="{{ cancel_url }}" class="btn" id="cancel_button">{% trans "Cancel" %}</a>
            </div>
          </div>
        </div>
      </div> <!-- row-fluid -->
    </li>
  </ul>
</div>
{#{% else %}#}
{#<div class="exhibit_edit">#}
{#  <ul class="exhibit_list_items">#}
{#    <li class="exhibit_list_item result_set_item clearfix">#}
{##}
{#      <div class="row-fluid">#}
{#        <div class="span7">#}
{#          <div class="exhibit-title">New View</div>#}
{#        </div>#}
{##}
{#        <div class="span5">#}
{#          <div class="exhibit-right exhibit-actions">#}
{#      <div class="exhibit-links btn-group">#}
{##}
{#        <div class="btn-group">#}
{##}
{#          <div class="btn-group">#}
{#            <button class="btn btn-info active btn-small">Build</button>#}
{#            <button class="btn btn-small btn-info dropdown-toggle" data-toggle="dropdown">#}
{#              <span class="caret"></span>#}
{#            </button>#}
{#            <ul class="dropdown-menu">#}
{#              <li><a href="#">Layout</a></li>#}
{#              <li><a href="#">Lens</a></li>#}
{#            </ul>#}
{#          </div>#}
{#          <div class="btn-group">#}
{#            <button class="btn btn-info btn-small">Preview</button>#}
{#            <button class="btn btn-small btn-info dropdown-toggle" data-toggle="dropdown">#}
{#              <span class="caret"></span>#}
{#            </button>#}
{#            <ul class="dropdown-menu">#}
{#              <li><a href="#">Darkness</a></li>#}
{#              <li><a href="#">Pepper Grinder</a></li>#}
{#              <li><a href="#">Smoothness</a></li>#}
{#              <li><a href="#">Sunny</a></li>#}
{#              <li><a href="#">Trontastic</a></li>#}
{#              <li><a href="#">Humanity</a></li>#}
{#            </ul>#}
{#          </div>#}
{##}
{#         </div>#}
{#        <input type="checkbox" class=" btn btn-small action_preview_exhibit" id="preview_toggle"><label for="preview_toggle">{% trans "Preview" %}</label></input>#}
{##}
{#	      <a href="" id="save_button" class="btn btn-small action_save_exhibit">{% trans "Save" %}<span id="save_message"></span></a>#}
{##}
{#	      <a href="{{ cancel_url }}" id="cancel_button" class="btn btn-small action_cancel_exhibit">{% trans "Cancel" %}</a>#}
{##}
{#	    </div>#}
{#          </div>#}
{#        </div>#}
{#      </div> <!-- row-fluid -->#}
{#    </li>#}
{#  </ul>#}
{#</div>#}
{#{% endif %}#}


<div id="contents">
  <div id="build" class="collapse">
    <div id="canvas">
        {% include canvas.location %}
    </div>
  </div>
  <div id="preview" class="collapse"></div>
  <div id="lens_navigator" class="collapse">
    {% include "exhibit/edit/lenses/lens_navigator.html" %}
  </div>
</div>

<script type="text/template" id="canvas-template">
    {% include canvas.location %}
</script>

{% block builder_templates %}
{# facets #}
{% include "exhibit/edit/facets/facet-editor.html" %}
{% include "exhibit/edit/facets/list-facet-editor.html" %}
{% include "exhibit/edit/facets/slider-facet-editor.html" %}
{% include "exhibit/edit/facets/numeric-facet-editor.html" %}
{% include "exhibit/edit/facets/logo-facet-editor.html" %}
{% include "exhibit/edit/facets/tagcloud-facet-editor.html" %}
{% include "exhibit/edit/facets/text-facet-editor.html" %}
{% include "exhibit/edit/facets/search-facet-editor.html" %}

{# views #}
{% include "exhibit/edit/views/list-view.html" %}
{% include "exhibit/edit/views/map-view.html" %}
{% include "exhibit/edit/views/piechart-view.html" %}
{% include "exhibit/edit/views/scatterplot-view.html" %}
{% include "exhibit/edit/views/table-view.html" %}
{% include "exhibit/edit/views/timeline-view.html" %}
{% include "exhibit/edit/views/thumbnail-view.html" %}

{# lenses #}
{% include "exhibit/edit/lenses/list-lens.html" %}
{% include "exhibit/edit/lenses/thumbnail-lens.html" %}
{% endblock %}

{% endblock body %}
